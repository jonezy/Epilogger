@using System.Globalization
@model IEnumerable<Epilogger.Web.Models.DashboardEventViewModel>
@{
    var currentMonth = string.Empty;
}

@foreach (var item in Model) {
    if (string.Format("{0:MMMM yyyy}", item.StartDateTime) != currentMonth)
    {
        if (currentMonth != string.Empty)
        {
            @:<div class="spacer"></div>
        }
        
        <div class="event-totals-icons">
            <img src="/Public/images/icons/eventListTotalIcons.png" alt="" />
        </div>
        
        currentMonth = string.Format("{0:MMMM yyyy}", item.StartDateTime);
        @:<span></span><h2>@currentMonth</h2>
        
    }
    <div class="dashboard-event-item clearfix">
        <div class="month-day">
            <div class="month">@Html.DisplayFor(thing => item.StartDateTime, "Month")</div>    
            <h2>@Html.DisplayFor(thing => item.StartDateTime, "Day")</h2>
            <h3>@Html.Encode(item.StartDateTime.Year)</h3>
            <div class="icon" style="background-image:url(@Url.Content("~/Public/images/date-icons/" + item.EventCategoryID + ".png"))"></div>
        </div>
        <div class="event-content">
            <h6>@Html.ActionLink(item.Name, "details", "events", new { @id = item.EventSlug }, null)
                @if (item.IsPaid)
                {
                    @:&nbsp;&nbsp;<img src="/Public/images/icons/paidEventSmall.png" alt="Upgraded Event" />
                }   
            </h6>
                
            <ul class="eventListMenu">
                <li>@Html.ActionLink("Edit Event", "edit", "Events", new { id = item.EventSlug }, null)</li>

                @if (item.IsPaid && item.UserID == item.CurrentUserId)
                {
                    <li></li>
                    <li></li>
                }
                else
                {
                    if (item.UserID == item.CurrentUserId)
                    {
                        <li>-</li>
                        <li>
                            @if (!item.IsPaid)
                            {
                                <a href="#" class="upgradeEventTrigger" onclick="return false;" value="@item.ID">Upgrade Event</a>    
                            }
                        </li>
                    }   
                }
            </ul>

            @*<div class="event-content-time">@Html.DisplayFor(thing => item.StartDateTime, "Time")</div>
            <div class="event-content-searchterms">@item.SearchTerms</div>*@
        </div>
        <div class="event-totals">
            <div class="total-tweets">@Epilogger.Web.Helpers.ConvertNumberToKorM(item.TotalTweets, true)</div>
            <div class="total-media">@Epilogger.Web.Helpers.ConvertNumberToKorM(item.TotalMedia, true)</div>
        </div>
    </div>
}